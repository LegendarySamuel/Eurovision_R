---
title: "Analyse: ESC-Erfolg und Lebenserwartung"
author: "SamuelFlorianMichael"
date: "2025-11-21"
output: 
  html_document:
    theme: flatly
    toc: true
---

```{r setup, include=FALSE}
# Grundeinstellungen
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
```

## 1. Einleitung

In diesem Bericht untersuchen wir, ob es einen statistischen Zusammenhang zwischen der durchschnittlichen Lebenserwartung eines Landes und seinem Erfolg beim Eurovision Song Contest (ESC) gibt.

## 2. Datenverarbeitung

Zunächst werden die Daten eingelesen und vorbereitet.

```{r daten-laden-und-verarbeiten}

eurovision <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2022/2022-05-17/eurovision.csv')
life_expectancy <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2023/2023-12-05/life_expectancy.csv')


# 1. Lebenserwartung bereinigen 
life_agg <- life_expectancy %>%
  rename(country = Entity) %>%
  filter(Year >= 1956 & Year <= 2022) %>% 
  group_by(country) %>%
  summarise(avg_life_exp = mean(LifeExpectancy, na.rm = TRUE))

# 2. Eurovision bereinigen 
euro_agg <- eurovision %>%
  filter(str_detect(section, "grand-final")) %>% 
  group_by(artist_country) %>% 
  summarise(avg_rank = mean(rank, na.rm = TRUE)) %>%
  rename(country = artist_country)

# 3. Datensätze verbinden 
plot_data <- inner_join(euro_agg, life_agg, by = "country")
```

## 3. Visualisierung

Die folgende Grafik zeigt den Zusammenhang. Jeder Punkt repräsentiert ein Land.

```{r grafik, fig.width=10, fig.height=6}
ggplot(plot_data, aes(x = avg_life_exp, y = avg_rank)) +
  geom_point(color = "steelblue", size = 3, alpha = 0.7) + 
  geom_smooth(method = "lm", color = "red", se = FALSE) +  
  geom_text(aes(label = country), vjust = 1.5, size = 3, check_overlap = TRUE) +
  labs(
    title = "Zusammenhang: Lebenserwartung und ESC-Erfolg",
    subtitle = "Durchschnittliche Platzierung vs. Durchschnittliche Lebenserwartung (1956-2022)",
    x = "Durchschnittliche Lebenserwartung (Jahre)",
    y = "Durchschnittliche Platzierung"
  ) +
  theme_minimal()
```

## 4. Statistische Auswertung

Wir prüfen die Hypothese mittels einer Pearson-Korrelation.

```{r statistik}
test_ergebnis <- cor.test(plot_data$avg_life_exp, plot_data$avg_rank)
modell <- lm(avg_rank ~ avg_life_exp, data = plot_data)
steigung <- coef(modell)["avg_life_exp"]

print(test_ergebnis)
```

### Interpretation

Die Analyse liefert folgende Werte:

* **Korrelation (r):** `r round(test_ergebnis$estimate, 3)`
* **p-Wert:** `r format.pval(test_ergebnis$p.value, eps = 0.001)`

**Fazit:**
Da der p-Wert kleiner als 0.05 ist, ist der Zusammenhang statistisch signifikant. Das Modell deutet darauf hin, dass pro Jahr zusätzlicher Lebenserwartung die Platzierung im Schnitt um etwa `r round(steigung, 2)` Plätze sinkt.
